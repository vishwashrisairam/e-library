/*! The-Noun-Project 2015-03-27 */
(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U=function(a,b){return function(){return a.apply(b,arguments)}};window.noun||(window.noun={}),J=window.noun,c=$("body"),window.navigator&&"preview"===window.navigator.loadPurpose&&(window.location.href=window.location.origin+"/topsites-preview/"),T=function(){return T=window.location.href.split("/")},J.url_to_array=T(),E=function(a){var b,c;return a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search),null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))},J.get_parameter_by_name=E,J.csrfmiddlewaretoken=$("meta[name=csrf-token]").attr("content"),G=function(){var a;return a=c.data("authentication"),a===!0?!0:!1},J.is_authenticed=G(),J.user=$("#user-config").data("user-object"),K=function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},J.number_with_commas=K,Modernizr.load({test:Modernizr.input.placeholder,nope:"//"+J.url_to_array[2]+"/static/compiled/components/jquery-placeholder/jquery.min.js"}),t=function(){return{status:void 0,url:void 0,page:1,count:1,limit:void 0,offset:0,pageLimit:72,template:$("#handlebar-template"),start_paginate_when_in_view:void 0,featurette_html:void 0,featurette_count:0,append_container:void 0,on_finish:void 0,finished:void 0,exhausted:!1,scroll_offset:void 0,init:function(a,b,c){"url = URL to ajax\nstart_paginate_when_in_view = where to start pagination\nappend_container = container to append to";var d,e,f;return J.icon_list.start_paginate_when_in_view=b,f=void 0===c?$("#results"):c.parent(),this.url=a,J.icon_list.status="loading",e=this.template.data("loading"),f.append(e),void 0===c&&(c=$("#results ol")),this.scroll_offset=void 0===this.scroll_offset?"110%":this.scroll_offset,void 0===this.limit?(J.icon_list.scroll(b,c),J.icon_list.append(c,this.on_finish)):J.icon_list.append(c,this.on_finish,d=this.limit)},scroll:function(a,b){return this.status="scrolling",a.waypoint(function(){return J.icon_list.finished===!0&&J.icon_list.append(b,J.icon_list.on_finish),J.icon_list.exhausted!==!0?$(".loading").removeClass("hidden"):void 0},{offset:J.icon_list.scroll_offset})},append:function(a,b,c){var d,e,f,g,h,i,j,k;return J.icon_list.finished=!1,k=this.template,d=J.icon_list.pageLimit,f=J.icon_list.page,e=J.icon_list.offset,h={page:f,limit:d,offset:e},i=$.param(h),this.page=f,g=-1===J.icon_list.url.indexOf("/collections")?J.icon_list.url+"?"+i:J.icon_list.url+"&"+i,j="down","down"===j?J.icon_list.page+=1:"up"===j&&(J.icon_list.page+=-1),$.getJSON(g,function(d){var e,f,g,h,i,j,l,m;for(i=d,l=k.html(),f=Handlebars.compile(l),m=i.uploads?{objects:i.uploads}:i.favorites?{objects:i.favorites}:i.downloads?{objects:i.downloads}:i.purchases?{objects:i.purchases}:{objects:i},0===m.objects.length&&($("#results .loading").addClass("hidden"),void 0!==J.icon_list.ajax_point&&J.icon_list.ajax_point.waypoint("destroy")),e=f(m),h=e.split('class="icon"'),g=0,j="";g<h.length;)g!==h.length-1&&(h[g]+="data-page='"+J.icon_list.count+"'"+"class='icon'"),j+=h[g],g++;return J.icon_list.count=J.icon_list.count+1,$("#results .loading").addClass("hidden"),J.icon_list.status="loaded",void 0!==J.icon_list.featurette&&0===J.icon_list.count%3&&(void 0!==J.icon_list.featurette[J.icon_list.featurette_count]?(j+=J.icon_list.featurette[J.icon_list.featurette_count],J.icon_list.featurette_count+=1):J.icon_list.featurette_count=0),void 0===a?$("#results ol").append(j):a.append(j),void 0!==J.icon_list.on_finish&&J.icon_list.on_finish(),$.waypoints("refresh"),void 0===c&&J.icon_list.page<2&&J.icon_list.append(a,b),J.icon_list.finished=!0}).fail(function(){var a,b;return a=J.url_to_array,b=a[3],$(".no-more-icons").length?void 0:(J.icon_list.append_container.parent().find($(".loading")).addClass("hidden"),$("#uploads .loading").addClass("hidden"),J.icon_list.callback(),J.icon_list.exhausted=!0,J.icon_list.page=7,J.icon_list.status="Error: No more icons for this term")})},fallbackIcon:function(a){return a.addClass("loading-new").attr("src","/static/img/fallback-icon.svg")},error:function(a,b){var c,d,e;return a.addClass("loading-new").attr("src","/static/img/fallback-icon.svg"),c=$('.list-of-icons li[data-id="'+b+'"]').data("page"),d=$("h1.term").html(),e="//"+J.url_to_array[2]+"/json_icon_list/"+d+"?page="+c,$.getJSON(e,function(c){"0";return $.map(c,function(c){return $('li[data-id="'+c.id+'"]').data("icon_url",c.icon_url),parseInt(c.id)===parseInt(b)?(a.attr("src",c.icon_url),a.removeClass("hidden").removeClass("loading-new")):void 0})})}}},J.icon_list=t(),o=function(){function a(a,c,k,l,m,n){var o,p,q;q=this,q.$wp_el=n,a=$(a),h=a.parent(),j=c,f=k,g=void 0!==m?m:50,void 0!==l&&(i=l),o=Backbone.Model.extend({defaults:{loading:'<div class="loading clearfix"><div class="dot dot1"></div><div class="dot dot2"></div><div class="dot dot3"></div><div class="dot dot4"></div></div>',error:"/static/img/fallback-icon.svg",id:0,term_slug:"None",preview_url:"None"},idAttribute:"cid"}),p=Backbone.Collection.extend({model:o,url:function(){return c}}),e=new p,d=new o,b=Backbone.View.extend({el:a,initialize:function(){this.render()},render:function(){var a,b,c,f,g,h,j;if("html"===i)a=e.models[0].attributes.html;else{for(b=Handlebars.compile(i.html()),c=[],j=e.models,g=0,h=j.length;h>g;g++)d=j[g],c.push(d.attributes);f={objects:c},a=b(f)}$(this.el).append(a),void 0!==q.on_finish&&q.on_finish()}}),h.append(d.attributes.loading),this.scroll()}var b,c,d,e,f,g,h,i,j;return c=void 0,h=void 0,e=void 0,d=void 0,f=void 0,g=void 0,b=void 0,j=void 0,i=$("#handlebar-template"),a.prototype.raw_html="false",a.prototype.$wp_el=void 0,a.prototype.on_finish=void 0,a.prototype.scroll=function(){var a,c,h,j;return j=this,h=!1,a=$("#footer"),c=void 0===j.$wp_el?a.length>0?a:$("#logout-form"):j.$wp_el,"html"===i&&(d=Backbone.Model.extend({defaults:{html:"",is_owner:""}}),e.model=d,j.raw_html="true"),c.waypoint(function(){return h===!1?($(".loading").removeClass("hidden"),e.fetch({data:{page:f,limit:g,raw_html:j.raw_html},success:function(){var a;return f+=1,(new J.Metrics).page_depth(f),a=new b,$(".loading").addClass("hidden"),$.waypoints("refresh")},error:function(){return $(".loading").addClass("hidden"),h=!0}})):void 0},{offset:"110%"})},a}(),J.Backbone_Icon_List=o,v=function(){return{element:'<div class="modal" data-type="" data-style=""></div>',status:void 0,authenticate:void 0,action:location.href.split("?action="),init:function(a,b,d,e,f,g){var h,i,j,k,l,m,n,o;switch(o="//"+J.url_to_array[2]+"/modals/"+a.type,m=$("[data-type='"+a.type+"']"),this.status="loading",i=function(b,d,f,g){if(J.modal.authenticate===!0){if(b.data("authenticate")===!1?(d.addClass("visible"),d.removeClass("hidden"),"full-blur"===d.data("style")&&c.addClass("blur"),this.status="loading",void 0!==e&&e(f)):(d=$(".login-signup-modal"),d.addClass("visible"),d.removeClass("hidden"),this.status="loading"),void 0!==g)return J.share_element=$(g)}else if(void 0!==g&&(J.share_element=$(g)),d.attr("data-type",a.type),d.addClass("visible"),d.removeClass("hidden"),"full-blur"===a.style&&(d.attr("data-style",a.style),c.addClass("blur")),this.status="loading",void 0!==e)return e(f)},b.attr("data-authenticate",a.authenticate),m.attr("data-type",a.type),m.attr("data-style",a.style),a.type){case"multi-function":m.removeClass("hidden"),j=m.find("[data-show]"),j.addClass("hidden"),j.removeClass("visible"),n=$("[data-show='"+a.data_element+"']"),n.removeClass("hidden"),n.addClass("visible")}switch(d){case"click":b.on(d,g,function(){var a,c;return c=$(this).attr("id"),$("body#term-detail").length>0||$("body#collaborative-collection").length>0?i(b,m,c):i(b,m,c,this),a="?action="+$("#"+c).data("action"),$(".login-signup-modal input[name=next]").val("/"+J.url_to_array[3]+"/"+J.url_to_array[4]+"/"+J.url_to_array[5]+a)});break;case"interval":switch(a.type){case"loading":l='<div class="modal loading-modal visible" data-type="loading" data-style="">                                        <div class="container row">                                            <div class="loading clearfix">                                                <div class="dot dot1"></div>                                                <div class="dot dot2"></div>                                                <div class="dot dot3"></div>                                                <div class="dot dot4"></div>                                            </div>                                        </div>                                    </div>',b.append(l),k=$(".loading-modal"),k.attr("data-style",a.style),$("body").addClass("blur")}break;case"auto-initialize":i(b,m)}return void 0!==J.modal.action[1]&&b.data("authenticate")===!0&&(a.type=J.is_authenticed===!0?"download":"login-signup",m=$(".modal."+a.type+"-modal"),m.removeClass("hidden"),i(void 0,m),J.modal.action[1]=void 0),J.is_authenticed===!1&&void 0===J.modal.authenticate?(a.type="login-signup",a.style="full-black",h=$(".modal."+a.type+"-modal"),this.status="loading",J.modal.authenticate=!0,this.status="loaded",h.attr("data-type",a.type),h.attr("data-style",a.style)):void 0},dismiss:function(){var a,b;return a=$(".modal"),a.addClass("hidden"),a.removeClass("visible"),$("body").removeClass("blur"),"function"==typeof(b=J.modal).reset_download&&b.reset_download(),$("#information-modal").length>0?($("#information-modal").removeClass("visible"),setTimeout(function(){return $("#information-modal").remove()},100)):void 0}}},J.modal=v(),s=function(){function a(){}var b,c;return c={},b={},a.prototype.drag_end=void 0,a.prototype.create_list=function(a){return a.sortable({update:function(){return void 0!==J.drag_and_drop_list.drag_end?J.drag_and_drop_list.drag_end():void 0}}),a.disableSelection()},a}(),J.drag_and_drop_list=new s,r=function(){function a(){var a,b,c;b="on",c="show",a=$(".new-form input:not([type='checkbox']):not([type='radio']), .new-form textarea, .new-form select"),a.hasClass("error")?a.on("focus",function(){return $(this).removeClass("error").next("label").removeClass("error show on")}):a.bind("checkval",function(){var a;return a=$(this).next("label"),""!==this.value?a.addClass(c):a.removeClass(c)}).on("keyup",function(){return $(this).trigger("checkval")}).on("focus",function(){return $(this).next("label").addClass(b)}).on("blur",function(){return $(this).next("label").removeClass(b)}).trigger("checkval")}return a}(),J.Clean_Form=new r,x=function(){function a(a,b,c,d,e){this.subscribe=U(this.subscribe,this),this.a_la_carte_successful=void 0,this.data=b,this.plan=c,this.action=d,this.username=e,this.set_publishable_key(a),this.validate()}return a.prototype.data={},a.prototype.plan={},a.prototype.errors={},a.prototype.set_publishable_key=function(a){return Stripe.setPublishableKey(a)},a.prototype.check_for_errors=function(a){a.errors&&a.errors.error&&a.errors.error.code&&(this.errors[a.errors.error.code]=a.errors.error.message,this.errored=!0)},a.prototype.validate=function(){return Stripe.card.validateCardNumber(this.data["card-number"])||(this.errors.card_declined="Your card was declined.",this.errored=!0),Stripe.card.validateExpiry(this.data["card-exp-month"],this.data["card-exp-year"])||(this.errors.card_expiry="Invalid expiration date",this.errored=!0),Stripe.card.validateCVC(this.data["card-cvc"])||(this.errors.incorrect_cvc="Your card’s security code is incorrect.",this.errored=!0),this.get_token(this.data)},a.prototype.get_token=function(){return Stripe.card.createToken({number:this.data["card-number"],cvc:this.data["card-cvc"],exp_month:this.data["card-exp-month"],exp_year:this.data["card-exp-year"],name:this.data["card-name"],address_line1:this.data.address1,address_line2:this.data.address2,address_city:this.data.city,address_state:this.data.state,address_zip:this.data.postal_code,address_country:this.data.country},this.subscribe)},a.prototype.update_card=function(a){var b;return b=this,b.data=a,$.ajax({url:"//"+J.url_to_array[2]+"/"+b.username+"/card/update/",type:"POST",data:a,success:function(a){"0";return b.check_for_errors(a),a.errors?void 0:(b.updated_data=a,b.updated=!0)},error:function(){"0";return b.updated["false"]}})},a.prototype.subscribe=function(a,b){var c;return c=this,200===a?"a-la-carte"===this.action?this.data.save_card===!0?(this.action="update-a-la-carte",this.update_card({csrfmiddlewaretoken:this.data.csrfmiddlewaretoken,stripe_token:b.id})):(this.data={csrfmiddlewaretoken:this.data.csrfmiddlewaretoken,stripe_token:b.id},this.stripe_responce=b,this.a_la_carte_successful=!0):this.update_card({csrfmiddlewaretoken:this.data.csrfmiddlewaretoken,stripe_token:b.id,company_name:this.data["company-name"],vat:this.data["vat-number"],plan:this.data.plan,seats:this.data.seats,coupon:this.data.coupon,next:this.data.next}):402===a?(this.errors.card_declined="We could not process your payment. Please try again later.",this.errored=!0,(new J.Metrics).failed_upgrade(J.user.id,b)):(this.errors.card_declined="Something went wrong. Please contact <a href='mailto:info@thenounproject.com?subject=Failed upgrade (status "+a.toString()+")' title='info@thenounproject.com'>info@thenounproject.com</a> for help",this.errored=!0,(new J.Metrics).failed_upgrade(J.user.id,b)),watch(this,"updated",function(){var a;if(c.updated===!0){switch(this.action){case"update":return location.reload(!0),void 0;case"update-a-la-carte":return this.stripe_responce=b,this.a_la_carte_successful=!0,void 0}if(this.check_for_errors(this.updated_data),void 0!==this.updated_data.card)switch(this.plan){case"pro":a="//"+J.url_to_array[2]+"/"+this.username+"/subscribe/pro/";break;case"team":a="//"+J.url_to_array[2]+"/"+this.username+"/subscribe/team/"}$.ajax({url:a,type:"POST",data:c.data,success:function(a,b){var d;return c.check_for_errors(a),a.errors?void 0:"undefined"==typeof a.next_url?(c.errors.card_declined="Something went wrong. Please contact <a href='mailto:info@thenounproject.com?subject=Failed upgrade (status "+b.toString()+")' title='info@thenounproject.com'>info@thenounproject.com</a> for help",c.errored=!0,(new J.Metrics).failed_upgrade(J.user.id,a)):($("button[type='submit']").addClass("success").removeClass("processing"),d="//"+J.url_to_array[2]+a.next_url,a.is_new_subscription?(new J.Metrics).upgrade(a,d):window.location.href=d)},error:function(){"0";return"0"}})}})},a.prototype.a_la_carte=function(a,b){return watch(this,"a_la_carte_successful",function(){var a;return a=this,this.updated===!0&&delete this.data.stripe_token,$.ajax({type:"POST",data:this.data,success:function(c){"0";return a.check_for_errors(c),c.errors?void 0:window.location.href="/icon/"+b+"/file-options/"},error:function(){"0";return a.parse_errors(a,stripe)}})})},a}(),J.Stripe=x,q=function(){function a(a,b){var c;c=this,c.form=a,c.action=b,$("#card-number").payment("formatCardNumber"),$("#"+a.prop("id")+" :input").on("focus",function(){var a,b;return a=$(this),a.removeClass("error"),b=a.nextAll("label"),b.removeClass("error"),b.text(b.data("label-text"))}),$("#card-number").on("keyup",function(){return c.update_card_type()}),$("#card-number").on("keydown",function(){return c.update_card_type()}),c.plan_type_selection(),$(".apply-coupon").length>0?($(".apply-coupon").on("click",function(a){return a.preventDefault(),c.apply_coupon($(this).parent().find("input"),c.render_applied_coupon)}),$(".coupon-name").on("click",function(a){return a.preventDefault(),$(".coupon-value").addClass("hidden"),$(".coupon-field").removeClass("hidden"),c.reset_plan_cost()})):$("#coupon").on("blur",function(){return c.apply_coupon($(this))}),c.date_selection(),a.submit(function(a){return $("#"+this.id+" ul li").children().removeClass("error"),a.preventDefault(),c.submit_btn.prop("disabled","true"),c.create_token()})}return a.prototype.form=void 0,a.prototype.is_valid=!0,a.prototype.coupon=null,a.prototype.errors={},a.prototype.submit_btn=$("button[type='submit']"),a.prototype.parse_errors=function(a,b){return b.errors.processing_error&&(a.render_error($("#card-number"),b.errors.processing_error),delete b.errors.processing_error),b.errors.incorrect_cvc&&(a.render_error($("#card-cvc"),b.errors.incorrect_cvc),delete b.errors.incorrect_cvc),b.errors.card_expiry&&(a.render_error($("#card-expiration"),b.errors.card_expiry),delete b.errors.card_expiry),b.errors.card_declined?(a.render_error($("#card-number"),b.errors.card_declined),delete b.errors.card_declined):void 0},a.prototype.render_error=function(a,b){var c;return c=a.nextAll("label"),a.addClass("error"),c.addClass("error show"),c.html(b),this.submit_btn.removeAttr("disabled"),this.submit_btn.removeClass("processing")},a.prototype.create_token=function(){var a,b,c,d,e,f,g,h,i;for(e=this,c=e.form,b={},i=c.find("input"),g=0,h=i.length;h>g;g++)d=i[g],a=$(d),a.prop("name").length>0?"plan"===a.prop("name")?a.prop("checked")===!0&&(b.plan=a.val()):b[a.prop("name")]="checkbox"===a.prop("type")?a.prop("checked"):a.val():"card-expiration"===a.prop("id")?(b["card-exp-month"]=a.val().split("/")[0],b["card-exp-year"]=a.val().split("/")[1]):b[a.prop("id").split(" ")[0]]=a.val();return this.submit_btn.addClass("processing"),f=new J.Stripe(c.attr("data-stripe-key"),b,$("body").prop("class").trim(),e.action,c.data("username")),void 0!==f.errors&&this.parse_errors(this,f),watch(f,"errored",function(){e.parse_errors(e,this)}),"a-la-carte"===this.action?f.a_la_carte(c.data("term-slug"),c.data("icon-id")):void 0},a.prototype.plan_type_selection=function(){var a,b,c;return a=$(".cost-total"),a.text($($("#plan-selection :input[type='radio']")[0]).data("plan-cost")),b=$(".seats"),b.on("keyup",function(){return c()}),$("#plan-selection").on("click","input",function(){return c(),$(".plan-monthly").prop("checked")?$(".month-year-interval").text("Monthly"):$(".plan-yearly").prop("checked")?$(".month-year-interval").text("Yearly"):void 0}),c=function(){var c,d;return b.length>0?(d=parseInt(b.val()),c=$("#plan-selection [type='radio']"),c.each(function(){var b,c;return b=$(this),isNaN(d)||0===d?c=1*b.data("plan-multiple"):(c=(d*b.data("plan-multiple")).toFixed(2),b.next().find(".dollar-value").text("$"+J.number_with_commas(c)),b.data("plan-cost",c),a.text(J.number_with_commas($("#plan-selection :checked").data("plan-cost"))))})):a.text($("#plan-selection :checked").data("plan-cost"))}},a.prototype.date_selection=function(){var a;return a=$("#card-expiration"),a.on("keyup",function(b){var c;return c=a.val(),2===c.length&&8!==b.keyCode?a.val(c+"/"):void 0})},a.prototype.update_card_type=function(){var a,b,c;return a=$("#card-number"),b=$("#card-type"),c=$("#card-number").prop("class").split(" ")[0],"unknown"!==c&&b.text(c),a.val()?void 0:b.text("")},a.prototype.apply_coupon=function(a,b){var c,d,e;return e=this,d=e.form,c=a.val(),""!==c?$.ajax({url:"//"+J.url_to_array[2]+"/coupon/"+c+"/",type:"GET",success:function(a){return e.process_coupon(a.coupon),"function"==typeof b?b(a.coupon):void 0},error:function(){return e.coupon=!1,e.render_error($("#coupon"),"This is not a valid coupon code"),e.reset_plan_cost()}}):e.reset_plan_cost()},a.prototype.process_coupon=function(a){var b;return b=this,b.coupon=a,$("input[name=plan]").each(function(){var c;return"undefined"!=typeof $(this).data("plan-cost-orig")?c=parseFloat($(this).data("plan-cost-orig")):(c=parseFloat($(this).data("plan-cost")),$(this).data("plan-cost-orig",c)),null!==a.percent_off&&(c-=c/100*a.percent_off),null!==a.amount_off&&(c-=a.amount_off),b.set_plan_cost($(this).attr("id"),c)})},a.prototype.render_applied_coupon=function(a){var b;return b=this,$(".coupon-field").addClass("hidden"),$(".coupon-name").text(a.code+": "+a.percent_off+"% off"),$(".coupon-value").removeClass("hidden")},a.prototype.set_plan_cost=function(a,b){var c,d,e,f,g;return b=b.toFixed(2),c=$(".cost-total"),d=$("#"+a),e=$("label[for="+a+"]"),g=e.html().split(" ").slice(1).join(" "),f="$"+String(b)+" "+g,d.data("plan-cost",b),e.html(f),d.is(":checked")?c.text(b):void 0},a.prototype.reset_plan_cost=function(){var a;return a=this,$("input[name=plan]").each(function(){var b;return b=$(this).data("plan-cost-orig"),"undefined"!=typeof b?a.set_plan_cost($(this).attr("id"),b):void 0})},a.prototype.reset_form=function(){return $("#plans-form input[type=text]").val("")},a}(),J.Billing_Form=q,u=function(){function a(){}return a.prototype.download=function(a,b){return mixpanel.track("Downloaded an icon",{"Download type":a,"File type":b}),ga("send","event","download",a,b)},a.prototype.upgrade=function(a,b){var c;return c=a.subscription,mixpanel.track("Upgraded",{"Account type":c.plan.name,Interval:c.interval,Seats:c.quantity,Price:c.plan.amount}),ga("send","event","account","upgrade",c.plan.name,{hitCallback:function(){window.location.href=b}})},a.prototype.downgrade=function(a){return ga("send","event","account","downgrade",a)},a.prototype.page_depth=function(a){return ga("send","event","page","scroll",a)},a.prototype.purchase_click=function(a){return ga("send","event","icon","two-click",a)},a.prototype.term_detail_arrow_keypress=function(a){return ga("send","event","term_detail","keypress",a)},a.prototype.tooltip_share=function(a){return ga("send","event","tooltip","share",a)},a.prototype.failed_upgrade=function(a,b){var c;if(ga("send","event","upgrade","failed",a),"undefined"!=typeof NREUM)try{throw{user_id:a,data:b}}catch(d){return c=d,NREUM.noticeError(c)}},a}(),J.Metrics=u,p=function(){function a(a,b,c){this.graph=a,this.render(b,c)}return a.prototype.graph=void 0,a.prototype.remove=function(){return d3.selectAll(this.graph+" > *").remove()},a.prototype.render=function(a,b){var c;return c=this.graph,this.remove(),nv.addGraph(function(){var d;return d=nv.models.discreteBarChart().x(function(a){return a[0]}).y(function(a){return a[1]}).staggerLabels(!1).tooltips(!0).showValues(!1).showYAxis(!1).transitionDuration(350).color(d3.scale.ordinal().range(["#4c4c4c"])),d.xAxis.showMaxMin(!1).tickFormat(function(a){return d3.time.format(b)(new Date(a))}),d.tooltipContent(function(b,c,d,e){return a=e.series.values[c-1],"<p>"+d+"</p>"}),d.valueFormat(d3.format(".0f")),d3.select(c).datum(a).transition().duration(500).call(d)})},a}(),J.Bar_Chart=p,H=function(a){return $(a).on("click",function(a){var b,c;return a.preventDefault(),b=$("#logout-form"),c=$(this).data("next"),c&&b.attr("action",b.attr("action")+"?next="+c),b.submit()})},J.logout_link=H,$(".modal-overlay").on("click",function(){return J.modal.dismiss()}),$(".modal-overlay .inner").on("click",function(a){return a.stopPropagation()}),J.loading_markup='<div class="loading clearfix"><div class="dot dot1"></div><div class="dot dot2"></div><div class="dot dot3"></div><div class="dot dot4"></div></div>',b=$(".banner"),J.user.is_anonymous===!1&&($("document").ready(function(){return b.removeClass("dismissed")}),$(".dismiss-banner").on("click",function(a){var b,c;return a.preventDefault(),b=$(this).parents(".banner"),c=b.data("callback"),b.slideUp(),"string"==typeof c?$.get("//"+J.url_to_array[2]+"/"+c,function(){return"0"}):void 0})),$(".multi-step").on("click",function(a){var b,c;return a.preventDefault(),b=$(this),c=b.attr("href"),$(c).length>0?($(this).removeClass("visible").addClass("hidden"),$(c).removeClass("hidden").addClass("visible")):window.location=c}),$(".button.progress").on("click",function(){var a;return a=$(this),a.toggleClass("processing"),setTimeout(function(){return a.removeClass("processing").addClass("success"),setTimeout(function(){return a.removeClass("success")},3e3)},1e4)}),$("#email-updates").submit(function(a){return a.preventDefault(),$.post(this.action,$(this).serialize()).done(function(b){return b.success&&(a.preventDefault(),$("#email-updates input#EMAIL").val(""),$("#email-updates label").addClass("ui_heart email-added"),$("#email-updates label").text("Thanks for joining the mailing list! Please check your email to confirm subscription.")),b.alreadySubscribed?(a.preventDefault(),$("#email-updates input#EMAIL").val(""),$("#email-updates label").addClass("ui_heart email-added"),$("#email-updates label").text("You're already subscribed!")):(a.preventDefault(),$("#email-updates label").addClass("shake"),$("#email-updates label").text(b.message))})}),$(".engage-something").on("click",function(a){var b,c;return a.preventDefault(),b=$(this),c=b.attr("href"),$(c).removeClass("hidden"),$("html,body").stop().animate({scrollTop:$(c).offset().top},500),b.addClass("hidden")}),$(".toggle-something").on("click",function(a){var b,c;return a.preventDefault(),b=$(this),c=b.attr("data-engage"),$(c).toggleClass("hidden"),$('*[data-engage="'+c+'"]').find("span").toggleClass("hidden")}),$("document").ready(function(){return $("#term-detail button[data-action=share]").on("click",function(){return ga("send","event","icon-button","click","share button")}),$("#term-detail #cc-by-download").on("click",function(){return ga("send","event","text-link","click","download and attribute link")}),$(".copy-attribution-to-clipboard").on("click",function(){return ga("send","event","icon-button","click","copy attribution to clipboard")}),$(".ui_personal a").on("click",function(){return ga("send","event","text-link","click","header hover nav")}),$(".download-options .upgrade .consume").on("click",function(){return ga("send","event","button","click","recommended upgrade button on download option modal")}),$(".download-options .buy-now .purchase").on("click",function(){return ga("send","event","button","click","buy it now button on download option modal")}),$(".download-options .attribution .attribute").on("click",function(){return ga("send","event","button","click","download with attribution button on download modal")}),$(".featurette-collection").on("click",function(){return ga("send","event","featurette","click","featured collection in featurette")}),$(".featurette-designer").on("click",function(){return ga("send","event","featurette","click","featured designer in featurette")}),$(".press-kit-button").on("click",function(){return ga("send","event","button","click","press kit download")})}),$(document).ready(function(){return $(".icon img").on("error",function(){return J.icon_list.fallbackIcon($(this))})}),$(document).bind("keydown",function(a){var b;switch(b=27,a.keyCode){case b:return J.modal.dismiss()}}),$("body").on("click","#kit-container",function(a){return a.stopPropagation()}),$("body").on("click",".new-custom-name",function(a){return a.stopPropagation()}),"undefined"==typeof String.prototype.trim&&(String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")}),$.fn.serializeObject=function(){var a,b;return b={},a=this.serializeArray(),$.each(a,function(){void 0!==b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""}),b},$("body").on("click","a.kit",function(a){var b,c,d;return a.preventDefault(),J.is_authenticed===!0?(C(),a.stopPropagation(),b=$(this),b.hasClass("ajaxing")||(b.addClass("ajaxing"),b.removeClass("ui_kit").addClass("ui_kit-open"),c=b.closest(".container"),c.addClass("kit-open"),$("body").addClass("kit-open"),d=c.find(".kit-container"),d.addClass("visible"),d.append(J.loading_markup),$.ajax({url:"/kit/retrieve/",method:"GET",data:{csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val(),username:$(".user-permalink").data("username"),icon_id:b.attr("data-icon-id")},success:function(a){var c,e,f;return b.removeClass("ajaxing"),d.find("form").length<=0?(d.append(a),$("#term-detail").length>0&&$(".kits_list").append($(".popup-kits-list")),d.find(".loading").remove(),d.find('input[type="search"]').focus(),$(".kit-name a").click(function(a){var b,c;return a.preventDefault(),b=$(this),$(this).addClass("match"),$(".popup-kits-list").css({border:"none"}),$(this).toggleClass("added ui_kit"),c=b.parent("li"),c.addClass("keeper"),$(".kit-name:not(.keeper)").remove(),d.find("input").remove(),d.find(".get-more-kits").remove(),d.find(".make-a-new-kit").remove(),d.find(".ui_search").remove(),$("a.kit").addClass("added"),b.addClass("inactive"),$.ajax({url:a.target.href,method:"POST",data:{csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(){"0";return setTimeout(function(){return C(),"0"},500)},error:function(){return b.removeClass("inactive"),"0"}})}),e=d.find('input[type="search"]'),c=d.find("span.message"),$(".make-a-new-kit").click(function(a){return a.preventDefault(),f(a,e.val())}),$("body").on("keyup",d,function(a){var c,g,h;if(h=$(e).val().toLowerCase(),13===a.keyCode){if(a.preventDefault(),1===$(".match").length)return c=$(".match").children("a")[0],$(c).hasClass("added")?C():$(c).click();if("True"===$("input[name='can_create_kits']").val())return f(a,e.val())}else if(g=d.find(".kit-name").length,d.find(".kit-name").each(function(){var a,c;return b=$(this),a=b.text().toLowerCase(),c=new RegExp(h),a.match(c)?(b.removeClass("not-a-match"),a.trim()===h.trim()||$(".not-a-match").length===g-1?b.addClass("match"):b.removeClass("match")):(b.addClass("not-a-match"),b.removeClass("match"))}),0===h.length)return b.removeClass("match")}),f=function(a,b){return a.preventDefault(),d.find("input[name=new-kit-name]").val(b),d.find(".kits_list").removeClass("visible"),d.find(".new_kit").addClass("visible"),d.find("textarea[name=new-kit-description]").focus(),d.find("form").submit(function(a){var b,e,f,g,h,i,j;return a.preventDefault(),g=d.find("input[name=new-kit-name]").val(),b=d.find("textarea[name=new-kit-description]").val(),i=d.find("select[name=new-kit-owner]").val(),f=null!=(j=$("input[name=new-kit-is_public]").prop("checked"))?j:{on:"off"},e=d.find("input[name=icon-id]").val(),$.ajax({url:"/kit/new/",method:"POST",dataType:"json",data:{csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val(),name:g,description:b,owner_id:i,icon_id:e,is_public:f,popup:!0},success:function(a){var b;return a.errors?h(a.errors.name[0]):(b=$(".kit-name:first-child"),b.addClass("keeper").removeClass("not-a-match"),b.find("a").text($("input[name=new-kit-name]").val()).addClass("added ui_kit"),b.appendTo(d),d.find("form").hide(),$("a.kit").addClass("added"),C())},error:function(a){"0";return h(a.responseJSON.description)}},h=function(a){return c.slideDown(500),c.text(a),c.addClass("ui_important"),setTimeout(function(){return c.slideUp(500)},2e3)})})}):void 0},error:function(){return d.html("<p>Couldn't get your kits. Try again.</p>"),setTimeout(function(){return C()},2e3)}})),$(".kit-container").click(function(){return event.stopPropagation()})):location.href="//"+J.url_to_array[2]+"/accounts/login/?next="+location.pathname}),C=function(){var a;return a=$(".kit-container.visible"),a.length>0?(a.removeClass("visible"),$("body").removeClass("kit-open"),$(".container.kit-open").removeClass("kit-open"),$("a.kit").addClass("ui_kit").removeClass("ui_kit-open","ajaxing"),setTimeout(function(){return a.find("form").remove(),a.find("li").remove()},500)):void 0},$(".create-new-kit").on("click",function(a){return a.preventDefault(),$(this).hide(),$("form#create-new-kit span.message").hide(),$("form#create-new-kit").addClass("visible")}),A=function(){return $(".card a.card-information").on("click",function(a){var b;return a.preventDefault(),b=$(this).parents(".card"),b.find("form.edit-kit-form").hide(),b.find(".delete-confirmation").hide(),b.find(".description").show(),b.toggleClass("flip")}),$(".card a.edit-kit-info").on("click",function(a){var b,c;return a.preventDefault(),c=$(this).parents(".card"),c.toggleClass("flip"),c.find(".description").hide(),c.find(".delete-confirmation").hide(),c.find("form").show(),b=c.find(".deny-edit-kit"),b.click(function(a){return a.preventDefault(),$(this).removeClass("loading"),c.removeClass("flip"),setTimeout(function(){return c.find("form.edit-kit-form").hide(),c.find(".description").show()},500)})}),$("footer a.delete-kit").on("click",function(a){var b,c,d;return a.preventDefault(),d=$(this).parents(".card"),d.addClass("flip"),d.find(".delete-confirmation").show(),d.find(".description").hide(),b=d.find(".confirm-delete-kit"),c=d.find(".deny-delete-kit"),b.click(function(){return a.preventDefault,$.ajax({url:a.target.href,method:"POST",data:{csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(){"0";
return F(d)},error:function(){"0";return $(this).removeClass("loading")}})}),c.click(function(){return $(this).removeClass("loading"),d.removeClass("flip"),d.find(".delete-confirmation").hide(),d.find(".description").show()})}),$("footer a.publicize-kit").on("click",function(a){var b;return a.preventDefault(),b=this,$(this).addClass("loading"),$.ajax({url:a.target.href,method:"POST",data:{csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(){"0";return R(b)},error:function(){"0";return $(b).removeClass("loading")}})}),$("footer a.lock-kit").on("click",function(a){var b;return a.preventDefault(),b=this,$(this).addClass("loading"),$.ajax({url:a.target.href,method:"POST",data:{csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(){"0";return Q(b)},error:function(){"0";return $(b).removeClass("loading")}})})},A(),$("body").on("click",".term .ui_pencil",function(a){var b,c;return a.preventDefault(),b=$(this),a.stopPropagation(),$("html").one("click",function(){return B(b)}),c=b.parents("footer"),c.find(".term").hide(),c.find("form").show(),c.find("input").focus()}),B=function(a){var b,c;return b=a,c=b.parents("footer"),c.find(".term").show(),c.find("form").hide()},$("body").on("submit","form.new-custom-name",function(a){var b,c,d;return a.preventDefault(),d=$(this).serializeObject(),d.csrfmiddlewaretoken=$("input[name=csrfmiddlewaretoken]").val(),b=$(this),c=b.find("button"),c.removeClass("ui_save"),c.addClass("loading"),$.ajax({url:a.target.action,method:"POST",data:d,success:function(a){"0";return c.removeClass("loading"),c.addClass("ui_save"),b.hide(),b.parent().find(".term").show(),b.parent().find(".term small.term-name").removeClass("hidden"),b.parent().find(".kiticon-name").text(a)},error:function(){return"0"}})}),$("form#create-new-kit").on("submit",function(a){var b,c,d,e,f;return a.preventDefault(),d=$(this).serializeObject(),c=$(this),b=c.find("button"),b.addClass("loading"),e=c.parent().find("span.message"),f=function(a){return e.slideDown(500),e.text(a),e.addClass("ui_important"),setTimeout(function(){return e.slideUp(500)},2e3)},$.ajax({url:a.target.action,method:"POST",data:d,success:function(a){return a.errors?f(a.errors.name[0]):(b.removeClass("loading"),c.removeClass("visible"),c[0].reset(),$(a).insertBefore($("#new-kit-card")),$(".create-new-kit").show(),A())}})}),$("body").on("click","a.delete-icon",function(a){var b;return a.preventDefault(),$(this).addClass("loading"),b=this,$.ajax({url:a.target.href,method:"POST",data:{csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(){"0";return $(b).removeClass("loading"),$(b).parent().addClass("deleting"),$(b).parent().hide(500),setTimeout(function(){return $(b).parent().remove()},500)},error:function(){return"0"}})}),$("form.edit-kit-form").on("submit",function(a){var b,c,d,e;return a.preventDefault(),d=$(this).serializeObject(),b=$(this),e=$(this).parents(".card"),c=b.find("button.confirm-edit-kit"),c.addClass("loading"),$.ajax({url:a.target.action,method:"POST",data:d,success:function(a){var d;return c.removeClass("loading"),e.removeClass("flip"),e.find(".description").text(a.description).show(),d=a.name.length>20?a.name.substring(0,20)+"…":a.name,e.find(".front span.name").text(d).attr("title",a.name),b.hide()},error:function(){return"0"}})}),$("#new-kit-card .get-more-kits").on("click",function(a){return a.preventDefault()}),F=function(a){return $(a).hide(500,function(){return $(a).remove()})},Q=function(a){return $(a).removeClass("loading"),$(a).toggleClass("ui_lock"),$(a).toggleClass("ui_unlock"),$(a).hasClass("ui_lock")?$(a).attr("title","Locked"):$(a).attr("title","Unlocked")},R=function(a){return $(a).removeClass("loading"),$(a).toggleClass("ui_eye"),$(a).toggleClass("ui_eye-off"),$(a).hasClass("ui_eye")?($(a).attr("title","Public"),$(a).siblings(".share").removeClass("hide")):($(a).attr("title","Private"),$(a).siblings(".share").addClass("hide"))},$("#logout-button").click(function(a){return a.preventDefault(),$("#logout-form").submit()}),J.is_authenticed===!0&&(g=$("#notifications-list"),m=$("#toggle-notification-view"),f=$("#loading"),z=!1,P=0,w=function(){function a(){var a,b,c;b=this.notifications_element,a=this,c="//"+J.url_to_array[2]+"/notifications/",$.get(c,function(c){return/^\s*$/.test(c)===!1&&(f.addClass("hidden"),$(this).removeClass("has_notification"),$.get("//"+J.url_to_array[2]+"/clear-notications/",function(){return"0"})),b.prepend(c),a.on_finish()}).error(function(){return f.addClass("hidden"),$("#no-notifications").removeClass("hidden")})}return a.prototype.notifications_element=$("#notifications-list"),a.prototype.on_finish=function(){return z=!0,$("html").on("click",function(){return $("#header").hasClass("drawer-open")?P=1:void 0}),$("#user-account-drop-down .ui_close").on("click",function(){return $("#header").hasClass("drawer-open")?P=1:void 0})},a}(),$("#toggle-notification-view").on("click",function(a){return a.preventDefault(),z===!1&&new w,$("#header:not(.drawer-open)").length>0?0===P?(g.removeClass("hidden"),m.addClass("active"),P=1):(g.addClass("hidden"),m.removeClass("active"),P=0):void 0}),$(".user-permalink").on("click",function(a){return a.preventDefault(),m.hasClass("active")?(m.removeClass("active"),g.addClass("hidden")):void 0})),i=$("#organization-drawer"),h=$("#user-account-drop-down .ui_close"),d=$("#header"),e=$("#language-drawer"),$(".language.drop-link").on("click",function(a){return a.preventDefault(),e.hasClass("active")?(e.removeClass("active"),d.removeClass("drawer-open")):(e.addClass("active"),d.addClass("drawer-open"))}),$(".user-permalink").on("click",function(a){return a.preventDefault(),i.hasClass("active")?(i.removeClass("active"),h.removeClass("active"),d.removeClass("drawer-open")):(d.parent(".sticky-wrapper").height("inherit"),i.addClass("active"),h.addClass("active"),d.addClass("drawer-open"))}),h.on("click",function(a){return a.preventDefault(),i.removeClass("active"),h.removeClass("active"),d.removeClass("drawer-open")}),$("html").on("click",function(){return d.hasClass("drawer-open")?($(".drawer-open").find(".drawer.active").removeClass("active"),h.removeClass("active"),d.removeClass("drawer-open"),"0"):void 0}),d.on("click",function(a){return d.hasClass("drawer-open")?(a.stopPropagation(),"0"):void 0}),D=J.url_to_array,S=D[2],L=D[4],M=D[5],j=$("#search"),k=j.find("#search-input"),a=$("#autocomplete"),N=null,O=300,I=!1,n={endpoint:"/json_icon_list/autocomplete/?term=",suggestionTemplate:Handlebars.compile('<li class="suggestion"><a href="/search/?q={{suggestion}}">{{suggestion}}</a></li>'),$suggestionsList:$(".autocomplete"),maxSuggestions:4,lastCharacters:0,init:function(){return this.trackExternalClicks(),this.watchKeyStrokes(),"0"},watchKeyStrokes:function(){var a;return a=this,k.on("keyup",function(b){var c,d;return d=38,c=40,b.keyCode!==c&&b.keyCode!==d?a.getSuggestions():void 0}),this.lastCharacters=k.val().length,"0"},trackExternalClicks:function(){var a;return a=$.proxy(this.stopWatchingKeyStrokes,this),$("#search").on("click.tracking",function(a){return a.stopPropagation()}),$("html").one("click",function(){return a(),"0"}),"0"},stopWatchingKeyStrokes:function(){return k.off("click.tracking"),this.clearAutocomplete(),"0"},minimumLength:function(a){return a.length>2},getSuggestions:function(){var a;return k.addClass("focus"),I===!1?(M=k.val(),a=void 0,this.minimumLength(M)?(N&&clearTimeout(N),N=setTimeout(function(){return a=this.sendQuery(M),a.done($.proxy(this.addSuggestions,this)).fail($.proxy(this.clearAutocomplete,this))}.bind(this),O)):this.lastCharacters>M.length&&this.clearAutocomplete(),this.lastCharacters=M.length):void 0},sendQuery:function(a){return $.ajax({url:this.endpoint+a,dataType:"json",type:"GET"})},addSuggestions:function(b){var c,d,e;return d=b.slice(0,this.maxSuggestions),e=this.suggestionTemplate,c=[],0===d.length?(this.clearAutocomplete(),void 0):($.each(d,function(a,b){return c.push(e({suggestion:b}))}),this.clearAutocomplete(),a.css("display","block"),this.$suggestionsList.html(c.join("")),a.addClass("autocomplete"))},clearAutocomplete:function(){return this.$suggestionsList.empty(),a.css("display","none"),a.removeClass("autocomplete"),k.removeClass("focus")}},$("document").ready(function(){var a,b;return"search"===L&&(b=M.replace("?q=",""),k.val(b)),I=!1,0!==k.length&&n.init(),""!==k.val()&&$("#search label[for='search-input']").on("click",function(b){return b.preventDefault(),a()}),a=function(){var a;return a=k.val().trim().replace(/\s+/g,"-").toLowerCase(),D="//"+S+"/search/?q="+a,window.location.href=D},$("#search-input").on("keydown",function(b){var c,d,e,f,g;switch(c=$(".suggestion"),e=13,g=38,d=40,b.keyCode){case d:return I=!0,c.hasClass("active")===!1?$(c[0]).addClass("active"):(f=c.index($(".suggestion.active")),$(c[f+1]).length>0&&($(c[f]).removeClass("active"),$(c[f+1]).addClass("active"))),I=!1;case g:return I=!0,f=c.index($(".suggestion.active")),$(c[f-1]).length>0&&($(c[f]).removeClass("active"),$(c[f-1]).addClass("active")),I=!1;case e:return $(".suggestion.active a").length>0&&k.val($(".suggestion.active a").html()),a()}})}),$(".section-nav").length&&(l=$(".section-nav"),l.length>0&&(l.waypoint("sticky"),$("section.user-icons").waypoint(function(){var a;return a=$(this).attr("id"),$(".section-nav .current").removeClass("current"),$('.section-nav a[href="#'+a+'"]').parent("li").addClass("current")},{offset:"100px"}),$(".section-nav a").on("click",function(a){var b,c;return a.preventDefault,$(".section-nav .current").removeClass("current"),$(this).parent("li").addClass("current"),location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname&&(c=$(this.hash),c=c.length?c:$("[name="+this.hash.slice(1)+"]"),b=c.offset().top,c.length)?($("html,body").animate({scrollTop:b-100},1e3),!1):void 0}))),$(document).ready(function(){var a,b;return $("#header").waypoint("sticky",{offset:-24}),a=$("#search").outerHeight(),b=-a,$("#search").waypoint("sticky",{offset:15}),$("#autocomplete").waypoint("sticky",{offset:40})}),y=function(){var a;return a=$(".tabbed-container"),{init:function(){"Initializes the tabs and click events";return window.location.hash,$(".tabbed-nav a").on("click",function(a){var b,c;return a.preventDefault(),b=$(this).attr("href"),c=$(this).parents(".tab"),J.tabbed_sections.switch_tab(c,b)}),"0"},switch_tab:function(b,c){"# If click on tab, bring up corresponding section";var d;return $(".tabbed-nav .tab").removeClass("active"),b.addClass("animating"),a.addClass("animating"),$(".tabbed-section").removeClass("visible-tab").addClass("hidden-tab"),clearTimeout(d),d=setTimeout(function(){return a.removeClass("animating"),$(".tabbed-section").removeClass("visible-tab").addClass("hidden-tab"),$(".tabbed-nav .tab").removeClass("active"),b.removeClass("animating").addClass("active"),$(c).removeClass("hidden-tab").addClass("visible-tab"),"#brief"===c?($("#upload-button").addClass("on-brief").removeClass("bottom stuck"),$(".key-requirements").addClass("on-brief").removeClass("bottom stuck"),J.activate_bottom()):$("#upload-button").removeClass("on-brief")},350)}}},J.tabbed_sections=y(),J.tabbed_sections.init(),c.on("click",".tip .share",function(){return(new J.Metrics).tooltip_share($(this).data("url"))}),Handlebars.registerHelper("ifvalue",function(a,b){return b.hash.value===a?b.fn(this):b.inverse(this)})}).call(this);